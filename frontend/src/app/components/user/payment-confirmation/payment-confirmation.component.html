<div class="payment-confirmation-container">
  <h1>Confirmación y Pago</h1>

  <!-- Mensaje de error -->
  <div *ngIf="errorMsg" class="error">{{ errorMsg }}</div>

  <!-- Resumen de pedido -->
  <div class="order-summary">
    <h2>Tu Pedido</h2>
    <ul class="summary-list">
      <li class="summary-item">
        <span class="label">Sabor:</span>
        <span class="value">
          {{ flavor?.nombre }} – €{{ (flavor?.precio || 0) | number:'1.2-2' }}
        </span>
      </li>

      <li class="summary-item">
        <span class="label">Tamaño:</span>
        <span class="value">
          {{ size?.nombre }} – €{{ (size?.precio || 0) | number:'1.2-2' }}
        </span>
      </li>

      <li class="summary-item">
        <span class="label">Hora de recogida:</span>
        <span class="value">{{ pickupTimeLabel }}</span>
      </li>

      <li class="summary-item">
        <span class="label">Subtotal:</span>
        <span class="value">€{{ subtotal.toFixed(2) }}</span>
      </li>

      <li class="summary-item">
        <span class="label">Tienes:</span>
        <span class="value">{{ puntosUsuario }} puntos</span>
      </li>

      <li class="summary-item">
        <span class="label">Puntos a usar:</span>
        <span class="value">
          <input
            type="number"
            min="0"
            [max]="maxRedeemable"
            [(ngModel)]="puntosAUsar"
            (ngModelChange)="calculateTotal()"
          />
          <small class="hint">
            ({{ loyalty.pointsPerEuro }} puntos = €1)
          </small>
        </span>
      </li>

      <li class="summary-item">
        <span class="label">Descuento por puntos:</span>
        <span class="value">€{{ descuento.toFixed(2) }}</span>
      </li>

      <li class="summary-item total">
        <span class="label">Total a pagar:</span>
        <span class="value bold">€{{ total.toFixed(2) }}</span>
      </li>
    </ul>
  </div>

  <button class="btn-primary" (click)="simulatePurchase()">
    Simular Compra
  </button>

  <div id="paypal-button-container" class="mt-4"></div>
</div>
