<div class="dashboard-wrapper page-wrapper">
  <div class="card dashboard-card">
    <header class="dashboard-header">
      <div class="brand">
        <div class="logo">YE</div>
        <div>
          <p class="eyebrow">Panel administrativo</p>
          <h1>Yogur Express</h1>
        </div>
      </div>
      <div class="header-actions">
        <button class="btn-secondary" (click)="showScheduleDialog = true">Ajustar horario</button>
        <button class="btn-secondary" (click)="showLoyaltyDialog = true">Configurar puntos</button>
        <button class="btn-ghost" (click)="onLogout()">Cerrar sesión</button>
      </div>
    </header>

    <section class="metrics-grid">
      <div class="metric card">
        <p class="muted">Pedidos pendientes</p>
        <h3>{{ pendingOrders?.length || 0 }}</h3>
      </div>
      <div class="metric card">
        <p class="muted">Inventario activo</p>
        <h3>{{ inventoryCount }}</h3>
      </div>
      <div class="metric card">
        <p class="muted">Productos</p>
        <h3>{{ productCount }}</h3>
      </div>
    </section>

    <nav class="dashboard-nav">
      <button (click)="setTab('stats')" [class.active]="activeTab==='stats'">Pedidos pendientes</button>
      <button (click)="setTab('products')" [class.active]="activeTab==='products'">Productos</button>
      <button (click)="setTab('inventory')" [class.active]="activeTab==='inventory'">Inventario</button>
    </nav>

    <section class="tab-content">
      <div *ngIf="activeTab==='stats'" class="tab-panel">
        <div *ngIf="pendingOrders?.length; else noPendientes" class="orders">
          <div class="order card" *ngFor="let o of pendingOrders">
            <div class="order-header">
              <div>
                <p class="code">#{{ codeLabel(o) }}</p>
                <p class="muted">Total {{ o.total?.toFixed?.(2) ?? o.total }} €</p>
              </div>
              <span class="badge tag-warning">{{ o.estado }}</span>
            </div>
            <div class="order-actions">
              <button class="btn-primary" (click)="markReady(o)">Marcar listo</button>
              <button class="btn-secondary" (click)="markDelivered(o)">Marcar completado</button>
              <button class="btn-ghost" (click)="markRejected(o)">Rechazar</button>
            </div>
          </div>
        </div>
        <ng-template #noPendientes>
          <div class="empty">No hay pedidos pendientes.</div>
        </ng-template>
      </div>

      <div *ngIf="activeTab==='products'" class="tab-panel">
        <app-manage-products></app-manage-products>
      </div>

      <div *ngIf="activeTab==='inventory'" class="tab-panel">
        <app-manage-inventory></app-manage-inventory>
      </div>
    </section>
  </div>
</div>

<app-schedule-settings-dialog
  *ngIf="showScheduleDialog"
  (closed)="showScheduleDialog = false">
</app-schedule-settings-dialog>

<app-loyalty-settings-dialog
  *ngIf="showLoyaltyDialog"
  (closed)="showLoyaltyDialog = false">
</app-loyalty-settings-dialog>
